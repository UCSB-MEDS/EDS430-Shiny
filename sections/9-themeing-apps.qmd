---
format: revealjs
---

##  {#LO-themeing data-menu-title="Learning Objectives - Themeing/Styling"}

[{{< fa book-open title="an open book" >}} Learning Objectives - Themeing/Styling Apps]{.slide-title}

<hr>

<p class="medium-body-text bottombr">By the end of this section, you should be equipped with:</p>

. . . 

<p class="small-text">[{{< fa angle-right title="a bullet point" >}}]{.teal-text} a number of different approaches for themeing and styling your shiny apps and dashboards</p>

. . . 
 
<p class="small-text">[{{< fa angle-right title="a bullet point" >}}]{.teal-text} a basic understanding of how to apply CSS & Sass styling to your app</p>

. . .

<p class="medium-body-text topbr">Packages introduced:</p> 

. . . 

<p class="small-text">[{{< fa box-open title="an open box" >}}]{.teal-text} `{bslib}`: provides tools for customizing Bootstrap themes directly from R for shiny apps and RMarkdowns</p>

. . . 

<p class="small-text">[{{< fa box-open title="an open box" >}}]{.teal-text} `{fresh}`: provides tools for creating custom themes for use with shiny, `shinydashboard`, and `bs4Dash` apps</p>

##  {#themeing-pkgs data-menu-title="~~~ Themeing Shiny Apps (with pkgs) ~~~" background="#053660"}

<div class="page-center vertical-center">
<p class="custom-subtitle bottombr">{{< fa paint-roller title="a paint roller" >}} Creating custom themes</p>
<p class="caption-text">*We've built some really cool apps so far, but they all have a pretty standard and similar appearance. In this section, we'll explore two packages for creating custom themes for your apps.*</p>
</div>

---

##  {#bslib data-menu-title="{bslib}"}

[Using the [`{bslib}` package](https://rstudio.github.io/bslib/) to theme Shiny apps]{.slide-title}

<hr>

<p class="body-text">The [`{bslib}` package](https://rstudio.github.io/bslib/) provides tools for customizing [Bootstrap themes](https://getbootstrap.com/docs/4.6/getting-started/theming/) directly from R, making custom themeing for Shiny apps (and R Markdown docs!) quite easy.</p>

:::: {.columns}

::: {.column width="45%"}
<center><p class="medium-body-text">Pros:</p></center>
<p class="small-text">[{{< fa check title="check mark" >}}]{.teal-text} easy to use</p>
<p class="small-text">[{{< fa check title="check mark" >}}]{.teal-text} includes a [real-time themeing widget](https://testing-apps.shinyapps.io/themer-demo/) to try out themes before applying them to your own app</p>
<p class="small-text">[{{< fa check title="check mark" >}}]{.teal-text} plays well with the `{thematic}` package for matching plot styling to app</p>
<p class="small-text">[{{< fa check title="check mark" >}}]{.teal-text} `{bslib}` does more than just themeing! Check out the [December 2022 announcement](https://shiny.rstudio.com/blog/announcing-new-r-shiny-ui-components.html) of new UI components made possible with the latest package release</p>
:::

::: {.column width="4%"}
:::

::: {.column width="45%"}
<center><p class="medium-body-text">Cons:</p></center>
<p class="small-text">[{{< fa xmark title="an 'x' mark" >}}]{.teal-text} does **not** work with `shinydashboard` (`{bslib}` is only intended for use with `shiny` *apps*)</p>
<p class="small-text">[{{< fa xmark title="an 'x' mark" >}}]{.teal-text} styling is constrained by the arguments available to `bs_theme()`</p>
:::

::::

. . . 

<center><p class="body-text topbr">**Let's practice applying new themes using `bslib` to our `one-file-app` (i.e. App #1)**</p></center>

---

##  {#bslib-prebuilt-themes data-menu-title="Pre-built themes with {bslib}"}

[Apply a pre-built theme with {bslib}]{.slide-title}

<hr>

<p class="small-text topbr">By default, Shiny uses the Bootstrap v3 theme (which is not so exciting). Change the theme to a slightly more modern Bootstrap v5 theme by setting the `theme` argument of `fluidPage()` to `bslib::bs_theme(version = 5)`, *or* supply `bs_theme()` with a pre-built bootswatch theme, as shown below (for a list of theme names, run `bootswatch_themes()` in your console):</p>

:::: {.columns}

::: {.column width="45%"}

<br>

```{r}
#| eval: false
#| echo: true
ui <- fluidPage(
  
  theme = bslib::bs_theme(bootswatch = "solar")
  
  # ~ additional UI code omitted for brevity ~
  
)
```

<p class="small-text">Check out the complete source code for App #1 [here](https://github.com/samanthacsik/EDS430-shiny-app/tree/main/single-file-app) (NOTE: applied themes are commented out).</p>
:::

::: {.column width="5%"}
:::

::: {.column width="45%"}
<center><img src="images/solar.png" alt="A shiny app depicting a title, subtitle sliderInput, scatterplot, checkboxGroupInput, and DT datatable, all stacked vertically. The pre-build bootswatch 'solar' theme has been applied, turning the background color dark blue and changing widget colors to dark gray or yellow. The background of the scatterplot is still white." width="550"/></center>
:::

::::

---

##  {#bslib-custom-themes data-menu-title="Custom themes with {bslib}"}

[Create a custom theme with {bslib}]{.slide-title}

<hr>

<p class="small-text">Alternatively, you can fully customize your own theme. Explore the [`bslib` vignette](https://rstudio.github.io/bslib/articles/bslib.html) for detailed instructions. A small example here:</p>

:::: {.columns}

::: {.column width="45%"}

<br>

```{r}
#| eval: false
#| echo: true
ui <- fluidPage(
  
  theme = bslib::bs_theme(
    bg = "#A36F6F", # background color
    fg = "#FDF7F7", # foreground color
    primary = "#483132", # primary accent color
    base_font = font_google("Pacifico"))
  
  # ~ additional UI code omitted for brevity ~
  
)
```

<p class="small-text">Check out the complete source code for App #1 [here](https://github.com/samanthacsik/EDS430-shiny-app/tree/main/single-file-app) (NOTE: applied themes are commented out).</p>
:::

::: {.column width="5%"}
:::

::: {.column width="45%"}
<center><img src="images/custom-bslib.png" alt="A shiny app depicting a title, subtitle sliderInput, scatterplot, checkboxGroupInput, and DT datatable, all stacked vertically. A custom theme, created using bs_theme() has been applied, turning the background color pink, changing widget colors to a dark magenta, and applying a cursive white font styling to all text. The background of the scatterplot is still white." width="550"/></center>
:::

::::

<p class="small-text">Be sure to check out the interactive themeing widget to test custom color/font/etc. combos by running `bs_theme_preview()` in your console, or visit the hosted version [here](https://testing-apps.shinyapps.io/themer-demo/). You can also call `bs_themer()` within your `server` function to open the theme customization UI alongside your own app.</p>

----

##  {#thematic data-menu-title="{thematic} for plot themeing"}

[Use {thematic} to extend your theme to plots]{.slide-title-smaller}

<hr>

<p class="small-text">You probably noticed that our scatterplot looks a little silly against the darker background of our themed app. Enter the [`{thematic}` package](https://rstudio.github.io/thematic/index.html), which is built to help simplify plot themeing. Call `thematic_shiny()` before launching your app to generate plots that reflect your application's `bs_theme()`. For example:</p>

:::: {.columns}

::: {.column width="45%"}

<br>

```{r}
#| eval: false
#| echo: true
#| code-line-numbers: "1"
thematic::thematic_shiny()

ui <- fluidPage(
  
  theme = bslib::bs_theme(
    bg = "#A36F6F", # background color
    fg = "#FDF7F7", # foreground color
    primary = "#483132", # primary accent color
    base_font = font_google("Pacifico"))
  
  # ~ additional UI code omitted for brevity ~
  
)
```
<p class="small-text">Check out the complete source code for App #1 [here](https://github.com/samanthacsik/EDS430-shiny-app/tree/main/single-file-app) (NOTE: applied themes are commented out).</p>

:::


::: {.column width="5%"}
:::

::: {.column width="45%"}
<center><img src="images/bslib-thematic.png" alt="A shiny app depicting a title, subtitle sliderInput, scatterplot, checkboxGroupInput, and DT datatable, all stacked vertically. A custom theme, created using bs_theme() has been applied, turning the background color pink, changing widget colors to a dark magenta, and applying a cursive white font styling to all text. The background of the scatterplot is now the same color (pink) as the background." width="550"/></center>
:::

::::

<p class="small-text">Read the [vignette](https://rstudio.github.io/thematic/index.html) to learn more about using the `thematic` package to help match plot fonts to the fonts applied across your app.</p>

---

##  {#fresh data-menu-title="{fresh}"}

[Using the [`{fresh}` package](https://dreamrs.github.io/fresh/) to theme Shiny apps & dashboards]{.slide-title-smaller}

<hr>

<p class="body-text">The [`{fresh}` package](https://dreamrs.github.io/fresh/) provides tools for creating custom themes to use in Shiny apps *and* dashboards -- set parameters of your theme using `create_theme()`, generate a stylesheet based off your specifications, and apply your stylesheet to your app.</p>

<br>

:::: {.columns}

::: {.column width="45%"}
<center><p class="medium-body-text">Pros:</p></center>
<p class="small-text">[{{< fa check title="check mark" >}}]{.teal-text} easy to use</p>
<p class="small-text">[{{< fa check title="check mark" >}}]{.teal-text} supports theme creation for *both* shiny apps and dashboards (and also `{flexdashboard}`s and [`{b4dash}` applications](https://rinterface.github.io/bs4Dash/index.html)) </p>
:::

::: {.column width="4%"}
:::

::: {.column width="45%"}
<center><p class="medium-body-text">Cons:</p></center>
<p class="small-text">[{{< fa xmark title="an 'x' mark" >}}]{.teal-text} styling is constrained by the variables available to `create_theme()`</p>
:::

::::

<br>

. . . 

<center><p class="body-text topbr">**Let's practice applying new themes using `fresh` to our `two-file-app` (i.e. App #2) and our `shinydashbaord` (i.e. App #3)**</p></center>

---

##  {#fresh-workflow data-menu-title="{fresh} workflow"}

[A general workflow for using `fresh` themes]{.slide-title-smaller}

<hr>

<p class="body-text topbr">Whether you're working on a shiny *app* or a shiny *dashboard*, you'll need the following:</p>

<p class="small-text topbr">**1.** a `/www` folder within your app's directory -- this is where we'll save the stylesheet (a `.css` file) that `fresh` will generate for us</p>
<p class="small-text topbr">**2.** a separate script for building our theme using the `create_theme()` function -- I recommend saving this to `~/scratch` (it seemed to cause issues when saved anywhere within my app directory)</p>

. . .

<p class="body-text topbr">Importantly, `create_theme()` takes **different variables** to set the parameters of your theme, depending on what type of app you're building: for **shiny apps**, you'll need to use [`bs_vars_*` variables](https://dreamrs.github.io/fresh/articles/vars-shiny.html), and for **shiny dashboards** you'll use [`adminlte_*` variables](https://dreamrs.github.io/fresh/articles/vars-shinydashboard.html) (examples on the following slides).</p>

<p class="body-text topbr">There are also a [couple ways](https://cran.r-project.org/web/packages/fresh/vignettes/fresh.html) to apply your finished theme to your app, but we'll use the method of generating a `.css` file, then calling that file in our app.</p>

---

##  {#create-fresh-app-theme data-menu-title="Create {fresh} app theme"}

[Creating a `fresh` theme for `two-file-app`]{.slide-title-smallest}

<hr>

<p class="small-text">In this example, we update the colors of our app's body, navbar, and tabPanels using the appropriate `fresh` [variables for shiny *apps*](https://dreamrs.github.io/fresh/articles/vars-shiny.html). We specify a file path, `two-file-app/www` (you'll need to create the `/www` directory, since we don't have one yet), where our stylesheet (e.g. `shiny_fresh_themes.css`, as shown here) file will be saved to.</p>

<p class="small-text">Of course, these color combos are *not* recommended, but chosen purely for demonstration purposes {{< fa face-smile title="a smiling face" >}}.</p>

```{r}
#| eval: false
#| echo: true
# in a separate script: ~/R/create_fresh_theme_shiny.R
# load library ----
library(fresh)

# create theme -----
create_theme(
  
  # you can supply a bootstrap theme to begin with
  theme = "default",

  # global styling
  bs_vars_global(
    body_bg = "#D2D0CA", # beige
    text_color = "#F23ACB", # hot pink
    link_color = "#0E4BE3" # royal blue
  ),

  bs_vars_navbar(
    default_bg = "#13CC13", # lime green
    default_color = "#66656C" # gray
  ),

  # tabPanels
  bs_vars_tabs(
    border_color = "#F90909" # red
  ),

  # generate css file
  output_file = "two-file-app/www/shiny_fresh_theme.css"
)

```

---

##  {#apply-fresh-apps-theme data-menu-title="Apply {fresh} app theme"}

[Apply a `fresh` theme to our app]{.slide-title-smaller}

<hr>

<p class="body-text">To apply our theme, provide the `theme` argument of your `fluidPage()` or `navbarPage()` with the name of our stylesheet. **Note:** shiny knows to look in the `/www` directory, so you can omit that from your file path, as shown below:</p>

<br>

:::: {.columns}

::: {.column width="45%"}

<br>

```{r}
#| eval: false
#| echo: true
# navbar page ----
ui <- navbarPage(

  theme = "shiny_fresh_theme.css"
  
  # ~ additional UI code omitted for brevity ~
  
) # END navbarPage
```

<p class="small-text">Check out the complete source code for App #2 [here](https://github.com/samanthacsik/EDS430-shiny-app/tree/main/two-file-app) (NOTE: applied themes are commented out).</p>

:::

::: {.column width="5%"}
:::

::: {.column width="45%"}
<center><img src="images/fresh_app.gif" alt="An app with a tan-colored background, lime green navbar, bright pink text, and blue links, showcasing how different components of a shiny app can be modified using the fresh packages." width="550"/></center>
:::

::::

---

##  {#fresh-shinydashboard data-menu-title="{fresh} shiny dashboard"}

[Creating a `fresh` theme for our `shinydashboard`]{.slide-title-smallest}

<hr>

<p class="smaller-text">In this example, we update the colors of our app's header, body, and sidebar using the appropriate `fresh` [variables for shiny *dashboards*](https://dreamrs.github.io/fresh/articles/vars-shinydashboard.html). We specify a file path, `shinydashboard/www` where our stylesheet (e.g. `shinydashboard_fresh_themes.css`, as shown here) file will be saved to. Again, these color combos are *not* recommended, but chosen purely for demonstration purposes.</p>

```{r}
#| eval: false
#| echo: true
# in a separate script: ~/R/create_fresh_theme_shinydashboard.R
# load libraries ----
library(fresh)

# create theme ----
create_theme(
  
  # change "light-blue"/"primary" color
  adminlte_color(
    light_blue = "#150B5A" # dark blue
  ),
  
  # dashboardBody styling (includes boxes)
  adminlte_global(
    content_bg = "#E7B5B5" # blush pink
  ),
  
  # dashboardSidebar styling
  adminlte_sidebar(
    width = "400px", 
    dark_bg = "#57F8F3", # light blue
    dark_hover_bg = "#BF21E6", # magenta
    dark_color = "#F90000" # red
  ),
  
  # generate css file
  output_file = "shinydashboard/www/shinydashboard_fresh_theme.css"
  
)
```

---

##  {#apply-fresh-dashboard-theme data-menu-title="Apply {fresh} dashboard theme"}

[Apply a `fresh` theme to our dashboard]{.slide-title-smaller}

<hr>

<p class="body-text">To apply our theme, use the `fresh::use_theme()` function inside your `dashboardBody`, providing it with the name of your stylesheet. **Note:** shiny knows to look in the `/www` directory, so you can omit that from your file path, as shown below:</p>

<br>

:::: {.columns}

::: {.column width="45%"}

<br>

```{r}
#| eval: false
#| echo: true
body <- dashboardBody(
  
  # set theme
  fresh::use_theme("shinydashboard_fresh_theme.css")
  
  # ~ additional dashboardBody code omitted for brevity ~
  
)
```

<p class="small-text">Check out the complete source code for the shinydashboard [here](https://github.com/samanthacsik/EDS430-shiny-app/tree/main/shinydashboard) (NOTE: applied themes are commented out).</p>

:::

::: {.column width="5%"}
:::

::: {.column width="45%"}
<center><img src="images/fresh-dashboard.gif" alt="A shinydashboard with a dark blue dashboardHeader, pink dashboardBody, light blue dashboardSidebar, red sidebar text, and bright pink sidebar menuItem highlights, showcasing how shinydashboards can be customized using the fresh package." width="550"/></center>
:::

::::

---

##  {#themeing-css-sass data-menu-title="~~~ Styling Shiny Apps (with CSS & Sass) ~~~" background="#053660"}

<div class="page-center vertical-center">
<p class="custom-subtitle bottombr">{{< fa paintbrush title="a paint brush" >}} Styling apps with CSS & Sass</p>
<p class="caption-text">*`bslib` & `fresh` are great ways to get started on your app customization journeys, but knowing some CSS & Sass can help you really fine-tune the appearance of your apps*</p>
</div>

---

##  {#sass-css data-menu-title="Sass & CSS"}

[Using Sass & CSS to style Shiny apps & dashboards]{.slide-title-smaller}

<hr>

<p class="body-text">You can write your own stylesheets using [CSS](https://www.w3.org/Style/CSS/Overview.en.html) and [Sass](https://sass-lang.com/) to fully customize your apps, from background colors, to font styles, to size and shape of elements, and more. Unlike `bslib` and `fresh`, these are *languages*, meaning they can be a bit more challenging to get started with (but the payoff it big!).</p>

<br>

:::: {.columns}

::: {.column width="45%"}
<center><p class="medium-body-text">Pros:</p></center>
<p class="small-text">[{{< fa check title="check mark" >}}]{.teal-text} applies to any web page (not just shiny apps)</p>
<p class="small-text">[{{< fa check title="check mark" >}}]{.teal-text} allows you to customize pretty much any aspect of your app</p> <p class="small-text">[{{< fa check title="check mark" >}}]{.teal-text} can be combined with themes generated using `bslib` or `fresh` to fine-tune your app's styling</p>
:::

::: {.column width="4%"}
:::

::: {.column width="45%"}
<center><p class="medium-body-text">Cons:</p></center>
<p class="small-text">[{{< fa xmark title="an 'x' mark" >}}]{.teal-text} a steeper learning curve/generally more complex than packages like `bslib` and `fresh`</p>
:::

::::

. . . 

<center><p class="body-text topbr">**We'll review a little bit about CSS & Sass, then practice writing and applying custom styling to apps and dashboards.**</p></center>

---

##  {#css-review data-menu-title="CSS Review/Resources"}

[Resources for a deeper dive]{.slide-title-smaller}

<hr>

<p class="body-text">We'll be doing a rather high-level and quick overview of Sass & CSS today, though I encourage you to check out the [Customizing Quarto Websites](https://ucsb-meds.github.io/customizing-quarto-websites/#/title-slide) workshop, which takes a much deeper dive (the information in that workshop is largely applicable here).</p>

. . . 

<p class="body-text topbr">[W3Schools](https://www.w3schools.com/css/default.asp) is my favorite online resource for all-things CSS -- in addition to really digestible descriptions and examples, they also offer interactive tutorials to get your hands on updating (and breaking) code (in a safe space, of course).</p>

<br>

<center><img src="images/w3.png" alt="The W3Schools logo, which is a green 'W' with a green '3' to the right." width="350"/></center>

---

##  {#what-are-sass-css data-menu-title="What are Sass & CSS"}

[What even is CSS? Sass?]{.slide-title-smaller}

<hr>

:::: {.columns}

::: {.column width="45%"}
<center><img src="images/css3.png" alt="The CSS 3 logo." height="400"/></center>
<center><p class="smaller-text">**CSS** (**C**ascading **S**tyle **S**heets) is a programming language that allows you to control how HTML elements look (e.g. colors, font styles, etc.) on a webpage.</p></center>
:::

::: {.column width="5%"}
:::

::: {.column width="45%"}

<br>

<center><img src="images/sass.png" alt="The Sass logo" width="550"/></center>

<center><p class="smaller-text topbr">**Sass** (**S**yntactically **A**wesome **S**tyle**s**heets) is a CSS extension language and CSS preprocessor -- meaning Sass needs to be converted (aka compiled) to CSS before it can be interpreted by your web browser.</p></center> 
:::

::::

---

##  {#css-rule-based data-menu-title="CSS is rule-based"}

[CSS is a rule-based language]{.slide-title-smaller}

<hr>

<p class="body-text">CSS is a rule-based language, meaning that it allows you to define groups of styles that should be applied to particular elements or groups of elements on a web page. For example, *"I want all level one headings (`<h1>` or `tags$h1()` as written in Shiny) in my app to be green with a bit of extra space between each letter"* could be coded as:</p>

<br>

:::: {.columns}

::: {.column width="45%"}
<center><img src="images/CSS_syntax.png" alt="An example of a CSS rule that modifies all h1 elements so that the text is green and that there's a bit more space between each letter." width="550"/></center>
:::

::: {.column width="5%"}
:::

::: {.column width="45%"}
<p class="small-text">[{{< fa angle-right title="a bullet point" >}}]{.teal-text} **Selectors** select the HTML element(s) you want to style (*e.g. level one headings, `<h1>`)*</p>
<p class="small-text">[{{< fa angle-right title="a bullet point" >}}]{.teal-text} **Declarations** sit inside curly brackets, `{}`, and are made up of [**property**](https://www.w3schools.com/cssref/index.php) and **value** pairs. Each pair specifies the property of the HTML element(s) you're selecting *(e.g. the color property of the element `<h1>`)*, and a value you'd like to assign to that property *(e.g. green)*</p>
<p class="small-text">[{{< fa angle-right title="a bullet point" >}}]{.teal-text} A property and it's corresponding value are separated by a colon, `:`. Declarations end with a semicolon, `;`</p>
:::

::::

<p class="body-text">There are a variety of CSS selectors -- check out some of the basics that will take you far in styling your apps, starting [on this slide](https://ucsb-meds.github.io/customizing-quarto-websites/#/selector-types) of the [Customizing Quarto Websites](https://ucsb-meds.github.io/customizing-quarto-websites/#/title-slide) workshop.</p>

---

##  {#css-3ways data-menu-title="3 ways to add CSS styling"}

[3 ways to add CSS styling to your apps]{.slide-title-smallest}

<hr>

<p class="small-text">You can **(1)** add styling directly to `tags`, **(2)** add CSS rules to your `header`, and/or **(3)** build a stylesheet that is applied to your app. **Creating a stylesheet is the preferred approach, and you should do this whenever possible.**</p>

::: {.panel-tabset}

## tags

<p class="smaller-text">Add styling directly to tags. **It's best not to use a lot of these!** It's easy to lose track of your "in-line" styling in large projects, you can't reuse rules easily, it's hard to keep styling consistent, and it's difficult to implement large stylistic changes.</p>

:::: {.columns}

::: {.column width="45%"}
```{r}
#| eval: false
#| echo: true
#..............................setup.............................
library(shiny)

#...............................ui...............................
ui <- fluidPage(
  
  # text color = purple
  tags$h1("My app title",
          style = "color: #711EBA;"),
  
  # text color = blue; increase space between letters
  tags$h3("Section 1",
          style = "color: #1E4DBA; letter-spacing: 4px;"),
  
  # no styling
  tags$h3("Section 2"),
  
  # increase border thickness and color green; round corners 
  tags$button("This is a button",
              style = "border: 2px solid #1EBA38; border-radius: 5px")
  
)

#.............................server.............................
server <- function(input, output) {}

#......................combine ui & server.......................
shinyApp(ui, server)
```
:::

::: {.column width="5%"}
:::


::: {.column width="45%"}
<center><img src="images/in-line_styling.png" alt="A basic app with a large purple level 1 header that reads, 'My App', a blue level 2 header that reads, 'Section 1' with a bit of extra space between letters, an un-styled level 2 header that reads, 'Section 2', and a button with a green border that reads, 'This is a button'." width="550"/></center>
:::

::::

## header

<p class="smaller-text">Add CSS rules to your app's header (`tags$head`). This is a little bit better than option 1 since it allows for the reuse of rules, however, styles can't be cached (i.e. saved for future usage when you reopen your app). **Note:** explore Google fonts [here](https://fonts.google.com/) and check out [this slide](https://ucsb-meds.github.io/customizing-quarto-websites/#/select-fonts) for instructions on selecting a font.</p>

:::: {.columns}

::: {.column width="45%"}
```{r}
#| eval: false
#| echo: true
#..............................setup.............................
library(shiny)

#...............................ui...............................
ui <- fluidPage(
  
  tags$head(
    tags$style("
    
      @import url('https://fonts.googleapis.com/css2?family=Lobster&display=swap');
    
      h1 {font-family: 'Lobster', cursive;}
      
      h3 {color: blue;}
      
      .wide-letters {letter-spacing: 4px;}
      
    "
    ) # END styles
  ), # END head
  
  tags$h1("My app title"),
  
  tags$h3("Section 1"),
  
  tags$h3(class = "wide-letters", "Section 2"),
  
  tags$button("This is a button")
  
)

#.............................server.............................
server <- function(input, output) {}

#......................combine ui & server.......................
shinyApp(ui, server)
```
:::

::: {.column width="5%"}
:::

::: {.column width="45%"}
<center><img src="images/header_styling.png" alt="A basic app with a large black level 1 header written in a cursive font that reads, 'My App', a blue level 2 header that reads, 'Section 1', a blue level 2 header that reads, 'Section 2' with a bit of extra space between letters, and an un-styled button that reads, 'This is a button'." width="550"/></center>
:::
::::

## stylesheets

<p class="smaller-text">Build a stylesheet (a `.css` file) inside your app's `www/` directory and apply your styles to your app's header (for shinydashboards, include your header inside `dashboardBody()`. **This is the most ideal approach** -- it allows for style reuse, caching, and keeps styling contained in one spot. **Tip:** use `touch styles.css` in the terminal to create a new `.css` file.</p>

:::: {.columns}

::: {.column width="33%"}
```{r}
#| eval: false
#| echo: true
# app.R
#..............................setup.............................
library(shiny)

#...............................ui...............................
ui <- fluidPage(
  
  tags$head(
    tags$link(rel = "stylesheet", type = "text/css", href = "styles.css")
  ),
  
  tags$h1("My app title"),
  
  tags$h3("Section 1"),
  
  tags$h3(class = "wide-letters", "Section 2"),
  
  tags$button("This is a button")
  
)

#.............................server.............................
server <- function(input, output) {}

#......................combine ui & server.......................
shinyApp(ui, server)
```
:::

::: {.column width="33%"}
```{css}
#| eval: false
#| echo: true
# www/styles.R
/*import google fonts (Josephine Slab (serif) & Heebo (sans serfi))*/
@import url('https://fonts.googleapis.com/css2?family=Heebo:wght@300&family=Josefin+Slab:wght@300&display=swap');

/* element selectors */
h1 {
  font-family: 'Heebo', sans-serif;
  color: #179A1F; /* green */
}

h3 {
  font-family: 'Josefin Slab', serif;
  color: #CA781C; /* orange */
}

button {
  background-color: #FCF982; /* yellow */
}


/* class selectors */
.wide-letters {
  letter-spacing: 4px;
}
```
:::

::: {.column width="33%"}
<center><img src="images/stylesheet_styling.png" alt="A basic app with a large green level 1 header that reads, 'My App' written in a sans-serif font, an orange level 2 header that reads, 'Section 1' with a bit of extra space between letters and written in a serif font, an orange level 2 header that reads, 'Section 2' written in a serf font, and a button with a yellow background that reads, 'This is a button'." width="550"/></center>
:::

::::

:::

---

##  {#dashboard-practice-css data-menu-title="Dashboard for practicing CSS"}

[Let's practice on a small dashboard first:]{.slide-title-smaller}

<hr>

::: {.panel-tabset}

## dashboard

<center><img src="images/dashboard_css.png" alt="" width="750"/></center>

## `ui.R`

```{r}
#| eval: false
#| echo: true
#........................dashboardHeader.........................
header <- dashboardHeader(
  
  # add title ----
  title = "Penguin Dashboard"
  
) # END dashboardHeader

#........................dashboardSidebar........................
sidebar <- dashboardSidebar(
  
  # sidebarMenu ----
  sidebarMenu(
    
    menuItem(text = "Dashboard", tabName = "dashboard", icon = icon("gauge"))
    
  ) # END sidebarMenu
  
) # END dashboardSidebar

#..........................dashboardBody.........................
body <- dashboardBody(
  
  # tabItems ----
  tabItems(
    
    # dashboard tabItem ----
    tabItem(tabName = "dashboard",
            
            # fluidRow ----
            fluidRow(
              
              # input box ----
              box(width = 4,
                  
                  checkboxGroupInput(
                    inputId = "penguin_species",
                    label = "Filter by species: ",
                    choices = c("Adelie", "Chinstrap", "Gentoo"),
                    selected = c("Adelie", "Chinstrap", "Gentoo")
                    
                  ) # END checkboxGroupInput
                  
              ), # END input box
              
              # output box ----
              box(width = 8,
                  
                  plotOutput(outputId = "penguin_plot")
                  
              ) # END output box
              
            ), # END fluidRow
            
    ) # END dashboard tabItem
    
  ) # END tabItems
  
) # END dashboardBody

#..................combine all in dashboardPage..................
dashboardPage(header, sidebar, body)
```

## `server.R`

```{r}
#| eval: false
#| echo: true
server <- function(input, output) {
  
  # penguin spp reactive df----
  penguin_spp <- reactive({
    
    palmerpenguins::penguins %>%
      filter(species %in% input$penguin_species) %>%
      select(species, island, bill_length_mm, bill_depth_mm)
    
  }) # END penguin spp reactive df
  
  
  # plot ----
  output$penguin_plot <- renderPlot({
    
    ggplot(penguin_spp(), aes(x = bill_length_mm, y = bill_depth_mm, color = species)) +
      geom_point() + 
      scale_color_manual(values = c("Adelie" = "#FEA346", "Chinstrap" = "#B251F1", "Gentoo" = "#4BA4A4"))
    
  }) # END plot 
  
}
```

## `global.R`

```{r}
#| eval: false
#| echo: true
# LOAD LIBRARIES ----
library(shiny)
library(shinydashboard)
library(tidyverse)
library(palmerpenguins)
```

:::

---

##  {#inspect-webpages data-menu-title="Inspecting"}

[What if I want to style an element, but don't know how to target it?]{.slide-title-smaller}

<hr>

<p class="small-text">Oftentimes, you'll have to do a bit of exploration to determine how to target specific elements for styling. In either your app viewer or web browser, right click on an element of interest and choose **Inspect** (or **Inspect Element**) to open up the underlying HTML and CSS. You can make temporary edits to your app (e.g. adding a background color, changing font sizes, etc.) to see how they look first, then copy the appropriate CSS rule into your stylesheet to apply to your app.</p>

<center><img src="images/inspect_orientation.png" alt="A shiny dashboard, opened in the RStudio viewer, with the Inspect pane open to the right. The top half of the inspect pane shows the underlying HTML and the bottom half shows the underlying CSS styles." width="550"/></center>

---

##  {#inspect-dashboard data-menu-title="Inspect dashboard box"}

[Inspect & identify how to update box styling]{.slide-title-smallest}

<hr>

<p class="smaller-text">For example, let's say I want to change the color of this shinydashboard's boxes and the color of the box text.</p> 

<p class="smaller-text">**First, we need to determine which type of HTML element creates our box.** Right clicking on a box and choosing **Inspect Element** pulls up the HTML and CSS files underlying the app. Hovering over different parts of the HTML highlights different elements in the UI. The box is highlighted when I hover over `<div class="box-body">` -- this tells me that boxes are formed using the `<div>` HTML element and they're assigned a class called `box-body`.</p> 

<p class="smaller-text">**Next, we can (temporarily) adjust the CSS rules that style these boxes to see how they work.** I can hop down to the CSS file (here, that's located in the bottom half of my sidebar, but depending on the size of your window/layout, the HTML and CSS might be side-by-side) and find the `.box-body` class selector. You can add property/value pairs and/or update existing property values to adjust the appearance of our box. Notice that changing the `.box-body` class selector updates **both** boxes -- upon inspecting the box containing our plot, you'll notice that it is also of class, `box-body`. Therefore changes to this class selector will apply to both boxes. *This process is purely for testing purposes -- refreshing your app will remove any of these changes.*</p>

<center><img src="images/inspecting.gif" alt="" width="550"/></center>

---

##  {#write-box-css data-menu-title="Write CSS for box styling"}

[Finally, apply box styling to our dashboard]{.slide-title-smaller}

<hr>

<p class="small-text">Now that we know that we can use the `box-body` class to customize the appearance of our boxes, let's create a stylesheet and add our new rules. The `shinydashboard` framework already provides the "standard" styling for boxes, contained in the `box-body` class. Anything we specify in our own stylesheet will build upon or modify existing styling.</p>

<p class="small-text">Remember to create a header and link your stylesheet within `dashboardBody()` to apply our styles.</p>

::: {.panel-tabset}

## Our updated shinydashboard

:::: {.columns}

::: {.column width="45%"}

<br>
<br>

<p class="body-text">Check out the complete code for this small example dashboard [here](https://github.com/samanthacsik/EDS430-shiny-app/tree/main/dashboard_css_example).</p>
:::

::: {.column width="5%"}
:::

::: {.column width="45%"}
<center><img src="images/orange-boxes.png" alt="An example shinydashboard with default colors (light blue dashboardHeader, dark blue dashboardSidebar, gray/blue dashboardBody) and two boxes, one containing a checkboxGroupInput and the other containing a scatterplot -- the box colors are colored orange, rather than the default white." width="550"/></center>
:::

::::


## `styles.css`
```{css}
#| eval: false
#| echo: true
.box-body {
  background-color: #FCAE82; /* light orange */
  color: #6368C6; /* purple-blue */
}
```

## `ui.R`
```{r}
#| eval: false
#| echo: true
#| code-line-numbers: "24-27"
#........................dashboardHeader.........................
header <- dashboardHeader(
  
  # add title ----
  title = "Penguin Dashboard"
  
) # END dashboardHeader

#........................dashboardSidebar........................
sidebar <- dashboardSidebar(
  
  # sidebarMenu ----
  sidebarMenu(
    
    menuItem(text = "Dashboard", tabName = "dashboard", icon = icon("gauge"))
    
  ) # END sidebarMenu
  
) # END dashboardSidebar

#..........................dashboardBody.........................
body <- dashboardBody(
  
  # link stylesheet
  tags$head(
    tags$link(rel = "stylesheet", type = "text/css", href = "styles.css"),
  ),
  
  # tabItems ----
  tabItems(
    
    # dashboard tabItem ----
    tabItem(tabName = "dashboard",
            
            # fluidRow ----
            fluidRow(
              
              # input box ----
              box(width = 4,
                  
                  checkboxGroupInput(
                    inputId = "penguin_species",
                    label = "Filter by species: ",
                    choices = c("Adelie", "Chinstrap", "Gentoo"),
                    selected = c("Adelie", "Chinstrap", "Gentoo")
                    
                  ) # END checkboxGroupInput
                  
              ), # END input box
              
              # output box ----
              box(width = 8,
                  
                  plotOutput(outputId = "penguin_plot")
                  
              ) # END output box
              
            ), # END fluidRow
            
    ) # END dashboard tabItem
    
  ) # END tabItems
  
) # END dashboardBody

#..................combine all in dashboardPage..................
dashboardPage(header, sidebar, body)
```

:::

---

##  {#what-about-sass data-menu-title="What about Sass?"}

[What about Sass?]{.slide-title-smaller}

<hr>

<p class="body-text">Okay, we wrote and applied some CSS styling to our apps, but what about Sass? You don't *need* to write any Sass at all, however, it provides a number of benefits, including helping to reduce repetition.</p> 

<p class="body-text">For example, let's say you're working on an app that uses three primary colors throughout:</p>

<center><img src="images/meds_colors.png" alt="A color palette consisting of three colors: dark blue, teal, and dark gray." width="400"/></center>

<p class="body-text topbr">You might imagine how often you’ll need to type those HEX codes out as you developing your stylesheet…it can get annoying rather quickly.</p>

---

##  {#sass-vars data-menu-title="Sass variables"}

[We can define and reference Sass variables throughout our stylesheet]{.slide-title-smaller}

<hr>

<p class="small-text">Sass allows us to define variables (in the form `$var-name: value;`) for our colors to reference instead of writing out their HEX codes each time:</p>

```{css}
#| eval: false
#| echo: true
// define Sass vars 

$darkblue: #053660;
$teal: #147C91;
$darkgray: #333333;

// use vars in CSS rules

h1 {
  color: $darkblue;
}

.button-styling {
  background: $teal;
  color: $darkblue; 
  border-color: $darkgray;
}

```

<p class="small-text">If you decide that you actually like a *different* shade of teal better, you’ll only need to update the hex code where you first define the `$teal` Sass variable, saving lots of time.</p>

---

##  {#sass-workflow data-menu-title="Sass workflow"}

[Sass for Shiny workflow]{.slide-title-smaller}

<hr>

<p class="body-text">To style apps using both Sass *and* CSS, you'll follow this general workflow:</p>

<p class="small-text topbr">**1.** Create a `.scss` file inside `~/myapp/www` using the `touch` command in the terminal (e.g. `cd` into the appropriate directory, then `touch styles.scss`). Write both your Sass variables and CSS rules in your `.scss` file (**Note:** you can write both Sass & CSS in a `.scss` file, but *only* CSS in a `.css` file)</p> 

<p class="small-text topbr">**2.** Compile (i.e. convert) Sass to CSS in `global.R` (or, if using a one-file app, at the top of your script before you define your UI) using the the `sass()` function from the [`{sass}` package](https://rstudio.github.io/sass/index.html) -- this will generate a `.css` file that our shiny app can actually use. Be sure to save your `.css` file to your app's `/www` directory.</p>

<p class="small-text topbr">**3.** Apply your styles to your app by linking to to your `.css` file in your app's header.</p>

<center><img src="images/sass_to_css_workflow.png" alt="A chart showing the Sass to CSS workflow -- begin with writing Sass variables and CSS rule in a .scss file, then use the sass R package to compile sass to css, and finally use your compiled .css file to apply your styles to your app." width="750"/></center>

---

##  {#write-sass data-menu-title="Write Sass"}

[Let's build our Sass file]{.slide-title-smaller}

<hr>

<p class="small-text">We'll practice on our `two-file-app` -- first, remove any reference to your `bslib` or `fresh` themes that we practiced applying earlier so that we're starting off with just the default shiny styling.</p>

. . . 

<p class="small-text">Next, create your Sass file within `two-file-app/www/`. Then, using your terminal, `cd` into `~/two-file-app/www` and use the `touch` command to create a `.scss` file (I'm calling mine `my_sass_styles.scss`).</p>

. . . 

<p class="small-text">Add Sass variables and CSS rules to `my_sass_styles.scss`:</p>

```{css}
#| eval: false
#| echo: true
// import 2 fonts
@import url('https://fonts.googleapis.com/css2?family=Karma&family=Prompt:wght@200&display=swap');

// fonts
$font-family-serif: 'Karma', serif;
$font-family-sans-serif: 'Prompt', sans-serif;

// colors
$green: #8ca376;
$blue: #525cd1; 
$orange: #E59C5E;
$yellow: #f0eaa5;
$white: #f1f7eb;

// element selectors

body {
  background-color: $green; 
  color: $white; 
}

h2 {
  letter-spacing: 5px;
  font-family: $font-family-serif;
}

h4 {
  color: $blue;
  font-family: $font-family-serif;
}

p {
  font-family: $font-family-sans-serif;
}

a {
  color: $orange;
}

// class selectors

.navbar-default {
  background-color: $yellow;
}

.btn.default.active {
  background-color: $green;
}
```

---

##  {#convert-sass data-menu-title="Convert Sass to CSS"}

[Then, compile Sass to CSS]{.slide-title-smaller}

<hr>

<p class="small-text">Because web browsers can only interpret CSS (not Sass), we need to compile our Sass to CSS. To do this, we can use the `sass()` function from the [`{sass}` package](https://rstudio.github.io/sass/index.html). We can do this in `global.R`. The `sass()` function requires two arguments: a sass file `input` and a file path + named `.css` file `output`.</p>

<p class="small-text">We also need to apply our styles to our app by linking this newly-generated `.css` file in our app's header.</p>

<p class="smaller-text">**Note:** After running your app, you should see a `my_sass_styles.css` file appear in `www/` -- it should look quite familiar, except all of our Sass variables have been converted to CSS.</p>

::: {.panel-tabset}

## our updated app

:::: {.columns}

::: {.column width="45%"}

<br>
<br> 

<p class="body-text">Check out the complete code for App #2 [here](https://github.com/samanthacsik/EDS430-shiny-app/tree/main/two-file-app) (NOTE: applied themes are commented out).</p>
:::

::: {.column width="5%"}
:::

::: {.column width="45%"}
<center><img src="images/app2_sass_css.png" alt="Our app, with our sass and css styling applied. The navbar is yellow, body is green, level 4 headings are blue, text is white, hyperlinks are orange, and header and body text font styles have been changed from the default." width="750"/></center>
:::

::::

## `global.R`
```{r}
#| eval: false
#| echo: true
# LOAD LIBRARIES ----
library(shiny)
library(sass)
# ~ additional libraries omitted for brevity ~

# COMPILE CSS ----
sass(
  input = sass_file("www/my_sass_styles.scss"),
  output = "www/my_sass_styles.css"
)

# ~ additional global.R objects omitted for brevity ~
```

## `ui.R`
```{r}
#| eval: false
#| echo: true
# navbar page ----
ui <- navbarPage(
  
  # add css file ----
  header = tags$head(
    tags$link(rel = "stylesheet", type = "text/css", href = "my_sass_styles.css")
  )
  
  # ~ additional UI elements omitted for brevity ~
)
```

## `my_sass_styles.css`
```{css}
#| eval: false
#| echo: true
@import url("https://fonts.googleapis.com/css2?family=Karma&family=Prompt:wght@200&display=swap");
body {
  background-color: #8ca376;
  color: #f1f7eb;
}

h2 {
  letter-spacing: 5px;
  font-family: "Karma", serif;
}

h4 {
  color: #525cd1;
  font-family: "Karma", serif;
}

p {
  font-family: "Prompt", sans-serif;
}

a {
  color: #E59C5E;
}

.navbar-default {
  background-color: #f0eaa5;
}

.btn.default.active {
  background-color: #8ca376;
}
```

:::
